"use strict";!function(){function o(o,e){e.otherwise("/"),o.state("home",{url:"/",views:{main:{templateUrl:"views/home.html",controller:"HomeCtrl"}}})}var e=angular.module("app",["ngFileUpload","ui.bootstrap","app-templates","ui.router"]);e.config(["$stateProvider","$urlRouterProvider",o])}(),function(){function o(o,e){return void 0===o?"":o.toFixed(e)}function e(o){return void 0===o?"":180*o/Math.PI}angular.module("app").filter("toFixed",function(){return o}),angular.module("app").filter("toDeg",function(){return e})}(),function(){function o(o,e){return{restrict:"E",template:"",scope:{imageSrc:"<",coords:"=",angle:"=",scale:"=",setCoords:"<",setAngle:"<",setScale:"<"},link:function(t,n,l){var a=angular.element('<div style="height: 100%; width: 100%; display: block;"></div>');n.append(a);var r=o.L.map(a[0],{center:[55,37],zoom:8,zoomAnimation:!0});o.L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://osm.org">OpenStreetMap</a> contributors',maxZoom:18,detectRetina:!1,updateWhenZooming:!1,updateWhenIdle:!0,reuseTiles:!1}).addTo(r),t.$watch("imageSrc",function(n){if(n){var l=new o.L.AdvancedImageOverlay(n).addTo(r);l.on("update",function(o){e(function(){t.coords=o.point,t.angle=o.angle,t.scale=o.scale})}),["Scale","Angle","Coords"].forEach(function(o){!function(o){t.$watch("set"+o,function(e){(e||0===e)&&l.setParam(o.toLocaleLowerCase(),e)})}(o)})}})}}}angular.module("app").directive("map",["$window","$timeout",o])}(),function(){function o(o,e,t,n){t("_ModalCtrl",{$scope:o,$uibModalInstance:n}),o.angle=e*(180/Math.PI),o.save=function(){n.close(o.angle)}}angular.module("app").controller("SetAngleDialogCtrl",["$scope","angle","$controller","$uibModalInstance",o])}(),function(){function o(o,e,t,n){t("_ModalCtrl",{$scope:o,$uibModalInstance:n}),o.coords=e,o.save=function(){n.close(o.coords)}}angular.module("app").controller("SetCoordsDialogCtrl",["$scope","coords","$controller","$uibModalInstance",o])}(),function(){function o(o,e,t,n){t("_ModalCtrl",{$scope:o,$uibModalInstance:n}),o.scale=e,o.save=function(){n.close(o.scale)}}angular.module("app").controller("SetScaleDialogCtrl",["$scope","scale","$controller","$uibModalInstance",o])}(),function(){function o(o,e){function t(){e.dismiss()}o.close=t,o.cancel=t}angular.module("app").controller("_ModalCtrl",["$scope","$uibModalInstance",o])}(),function(){angular.module("app").controller("HomeCtrl",["$scope","Upload","$timeout","$uibModal",function(o,e,t,n){o.upload=function(o){e.upload({url:"upload-url",data:{file:o}})},o.openSetCoordsDialog=function(){var e=n.open({animation:!1,templateUrl:"views/modal/setCoordsDialog.html",controller:"SetCoordsDialogCtrl",resolve:{coords:function(){return o.coords}}});e.result.then(function(e){o.setCoords=e})},o.openSetScaleDialog=function(){var e=n.open({animation:!1,templateUrl:"views/modal/setScaleDialog.html",controller:"SetScaleDialogCtrl",resolve:{scale:function(){return o.scale}}});e.result.then(function(e){o.setScale=e})},o.openSetAngleDialog=function(){var e=n.open({animation:!1,templateUrl:"views/modal/setAngleDialog.html",controller:"SetAngleDialogCtrl",resolve:{angle:function(){return o.angle}}});e.result.then(function(e){o.setAngle=e})}}])}();